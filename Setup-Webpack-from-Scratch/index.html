<!DOCTYPE html>













<html class="theme-next muse" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=6.7.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.7.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.7.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.7.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="What is the difference between __dirname and ./ in NodejsThree different situations need to be considered.   In Nodejs, __dirname and __filename are always the directories in which these scripts resid">
<meta name="keywords" content="__dirname,path,..&#x2F;,.&#x2F;,require,readFileSync">
<meta property="og:type" content="article">
<meta property="og:title" content="Setup Webpack from Scratch">
<meta property="og:url" content="http://blog.magicefire.com/Setup-Webpack-from-Scratch/index.html">
<meta property="og:site_name" content="Qubo Qin&#39;s Blog">
<meta property="og:description" content="What is the difference between __dirname and ./ in NodejsThree different situations need to be considered.   In Nodejs, __dirname and __filename are always the directories in which these scripts resid">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://blog.magicefire.com/Setup-Webpack-from-Scratch/webpack-module-bundler.png">
<meta property="og:image" content="http://blog.magicefire.com/Setup-Webpack-from-Scratch/webpack-error-1.png">
<meta property="og:image" content="http://blog.magicefire.com/Setup-Webpack-from-Scratch/webpack-error-2.png">
<meta property="og:image" content="http://blog.magicefire.com/Setup-Webpack-from-Scratch/webpack-error-3.png">
<meta property="og:image" content="http://blog.magicefire.com/Setup-Webpack-from-Scratch/webpack-error-4.png">
<meta property="og:updated_time" content="2019-01-03T00:19:12.300Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Setup Webpack from Scratch">
<meta name="twitter:description" content="What is the difference between __dirname and ./ in NodejsThree different situations need to be considered.   In Nodejs, __dirname and __filename are always the directories in which these scripts resid">
<meta name="twitter:image" content="http://blog.magicefire.com/Setup-Webpack-from-Scratch/webpack-module-bundler.png">






  <link rel="canonical" href="http://blog.magicefire.com/Setup-Webpack-from-Scratch/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Setup Webpack from Scratch | Qubo Qin's Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Qubo Qin's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.magicefire.com/Setup-Webpack-from-Scratch/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qubo Qin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Qubo Qin's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Setup Webpack from Scratch

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-31 16:25:26" itemprop="dateCreated datePublished" datetime="2018-12-31T16:25:26-08:00">2018-12-31</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-01-02 16:19:12" itemprop="dateModified" datetime="2019-01-02T16:19:12-08:00">2019-01-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Nodejs/" itemprop="url" rel="index"><span itemprop="name">Nodejs</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="What-is-the-difference-between-dirname-and-in-Nodejs"><a href="#What-is-the-difference-between-dirname-and-in-Nodejs" class="headerlink" title="What is the difference between __dirname and ./ in Nodejs"></a>What is the difference between __dirname and ./ in Nodejs</h2><p>Three different situations need to be considered. </p>
<ol>
<li>In Nodejs, <code>__dirname</code> and <code>__filename</code> are always the directories in which these scripts reside.</li>
<li>By contrast, <code>./</code> and <code>../</code> are the directories from which you run these scripts in Nodejs environment when you use libraries like <code>path</code> and <code>fs</code>.</li>
<li>The paths in <code>require</code> are alway relative to these files.<br>FOr more detail information, here is the <a href="https://stackoverflow.com/questions/8131344/what-is-the-difference-between-dirname-and-in-node-js" target="_blank" rel="noopener">reference link</a> on Stackoverflow.   </li>
</ol>
<p>I give an example below, our directory is like this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">webpack-learning/src</span><br><span class="line">├── app</span><br><span class="line">└── server</span><br><span class="line">    ├── index.js</span><br><span class="line">    └── utils</span><br><span class="line">        └── pathtest.js</span><br></pre></td></tr></table></figure></p>
<p>and the <code>server/utils/pathtest.js</code> contains<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(chalk.yellow(<span class="string">'__filename = %s \n__dirname = %s'</span>, __filename, path.resolve(__dirname)))</span><br><span class="line">  <span class="built_in">console</span>.log(chalk.yellow(<span class="string">'. = %s'</span>, path.resolve(<span class="string">'.'</span>)))</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">require</span>(<span class="string">'../../../assets/media/config.json'</span>))</span><br><span class="line">  <span class="built_in">console</span>.log(chalk.yellow(fs.readFileSync(path.resolve(__dirname, <span class="string">'../../../assets/media/sometext.txt'</span>), <span class="string">'utf8'</span>)))</span><br><span class="line">  <span class="built_in">console</span>.log(chalk.red.bgYellow(<span class="string">'the next readFileSync() will throw out an exception if the working directory is not on the top of src!'</span>))</span><br><span class="line">  <span class="built_in">console</span>.log(chalk.red.bgYellow(fs.readFileSync(<span class="string">'./assets/media/sometext.txt'</span>, <span class="string">'utf8'</span>)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>the <code>server/index.js</code> is<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">'./utils/pathtest'</span>)()</span><br></pre></td></tr></table></figure></p>
<p>When we run the script in the parent directory of <code>src</code>,<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  webpack-learning git:(testpath) node src/server/index.js</span><br></pre></td></tr></table></figure></p>
<p>we get this result in the console.<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__filename = %s</span><br><span class="line">__dirname = %s /Users/qinqubo/Magicefire/Playground/webpack-learning/src/server/utils/pathtest.js /Users/qinqubo/Magicefire/Playground/webpack-learning/src/server/utils</span><br><span class="line">. = %s /Users/qinqubo/Magicefire/Playground/webpack-learning</span><br><span class="line">&#123; hello: 'world' &#125;</span><br><span class="line">some txt</span><br><span class="line">the next readFileSync() will throw out an exception if the working directory is not on the top of src!</span><br><span class="line">some txt</span><br></pre></td></tr></table></figure></p>
<p>If we run this script in other directory, the second <code>readFileSync</code> function call will throw out an error in the console like this,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">some txt</span><br><span class="line">the next readFileSync() will throw out an exception if the working directory is not on the top of src!</span><br><span class="line">fs.js:646</span><br><span class="line">  return binding.open(pathModule._makeLong(path), stringToFlags(flags), mode);</span><br><span class="line">                 ^</span><br><span class="line"></span><br><span class="line">Error: ENOENT: no such file or directory, open &apos;./assets/media/sometext.txt&apos;</span><br><span class="line">    at Object.fs.openSync (fs.js:646:18)</span><br><span class="line">    at Object.fs.readFileSync (fs.js:551:33)</span><br><span class="line">    at module.exports (/Users/qinqubo/Magicefire/Playground/webpack-learning/src/server/utils/pathtest.js:13:37)</span><br><span class="line">    at Object.&lt;anonymous&gt; (/Users/qinqubo/Magicefire/Playground/webpack-learning/src/server/index.js:1:90)</span><br><span class="line">    at Module._compile (module.js:652:30)</span><br><span class="line">    at Object.Module._extensions..js (module.js:663:10)</span><br><span class="line">    at Module.load (module.js:565:32)</span><br><span class="line">    at tryModuleLoad (module.js:505:12)</span><br><span class="line">    at Function.Module._load (module.js:497:3)</span><br><span class="line">    at Function.Module.runMain (module.js:693:10)</span><br></pre></td></tr></table></figure></p>
<p>You can examine the differences between the two <code>readFileSync</code> function calls. Because the second one use <code>../</code> as its path, and these <code>./</code> and <code>../</code> are depended on the directory where you run the script. So the second one got an error.</p>
<p>I pushed the example code on <a href="https://github.com/quboqin/webpack-learning" target="_blank" rel="noopener">Github</a>, you can check out on the <code>test-path</code> branch.</p>
<h2 id="The-Paths-in-the-webpack-config-js"><a href="#The-Paths-in-the-webpack-config-js" class="headerlink" title="The Paths in the webpack.config.js"></a>The Paths in the <code>webpack.config.js</code></h2><h4 id="Common-Options"><a href="#Common-Options" class="headerlink" title="Common Options"></a>Common Options</h4><p>The <code>Webpack</code> is a compiler which reads a file specified by <code>config.entry</code> and recursively builds a dependency graph and then packages all these artifacts into a group of bundles(or a single bundle). </p>
<p><img src="/Setup-Webpack-from-Scratch/webpack-module-bundler.png" width="50%" margin="auto"></p>
<p>So a bunch of options of <code>config</code> in the <code>webpack.config.js</code> are about how to find the the <strong>input files</strong> in our project folder, and the others are used to figure out where the <code>Webpack</code> keep the <strong>output files</strong>. Some of these properties give absolute paths, some of them are relative to other options.</p>
<p>The table below gives some examples about the <strong>input</strong> options</p>
<table>
<thead>
<tr>
<th>name</th>
<th>role</th>
<th>default value</th>
<th>dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>context</td>
<td>The base directory, an absolute path, for resolving entry points and loaders from configuration.</td>
<td>The default value is <code>process.cwd()</code> but it’s recommended to replace it with an absolute address <code>context: path.resolve(__dirname, &#39;app&#39;)</code></td>
<td></td>
</tr>
<tr>
<td>entry</td>
<td>The point or points to enter the application</td>
<td></td>
<td><code>context</code> If entry is an absolute address, the context will be ignored</td>
</tr>
<tr>
<td>template(html-webpack-plugin)</td>
<td>require path to the template.</td>
<td>‘’</td>
<td><code>context</code></td>
</tr>
</tbody>
</table>
<p>When we discuss the <strong>output</strong>, we need to seperate 2 different situations. If we just let the <code>Webpack</code> package the bundle for us, then the <code>Webpack</code> create all <strong>output files</strong> on the disk. But<br>when we use the <code>webpack-dev-server</code>, the web server will mount these <strong>output files</strong> in the memory. The options are somewhat different.</p>
<p>Now we use <code>webpack webpack --config ./build/webpack.config.js</code> to create a distribute folder, here is the options we need to specify.</p>
<table>
<thead>
<tr>
<th>name</th>
<th>role</th>
<th>default value</th>
<th>dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>output.path</td>
<td>The output directory as an absolute path.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>output.filename</td>
<td>This option determines the name of each output bundle.</td>
<td></td>
<td>The bundle is written to the directory specified by the <code>output.path</code> option</td>
</tr>
<tr>
<td>outputPath(file-loader)</td>
<td></td>
<td></td>
<td><code>output.path</code></td>
</tr>
<tr>
<td>filename(HtmlWebpackPlugin)</td>
<td></td>
<td></td>
<td><code>output.path</code></td>
</tr>
</tbody>
</table>
<p>When we start the <code>webpack-dev-server</code>, some of the options are different.</p>
<table>
<thead>
<tr>
<th>name</th>
<th>role</th>
<th>default value</th>
<th>dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>devServer.publicPath</td>
<td>Its role is same as the role of <code>output.path</code>. The differency is that it is mounted in the memory and as part of URL address which only be accessed from a web browser through the <code>express</code> server.</td>
<td>‘/‘</td>
<td></td>
</tr>
<tr>
<td>devServer.contentBase</td>
<td>Tell the server where to serve content from. This is only necessary if you want to serve static files. devServer.publicPath will be used to determine where the bundles should be served from, and takes precedence. <strong>I think this option is useless and confused</strong>. Maybe when some resources are not packaged into our bundle, but can be accessed under the run time. In this case, maybe we would use this option.</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="The-Most-Confused-Part-publicPath"><a href="#The-Most-Confused-Part-publicPath" class="headerlink" title="The Most Confused Part, publicPath"></a>The Most Confused Part, <code>publicPath</code></h4><p>The most confused parts in the config of the <code>Webpack</code> are the two <code>publicPath</code>s. One is the <code>devServer.publicPath</code> we mention it before. The other is the <code>output.publicPath</code>. The latter in most case is a placeholder used by <code>loaders</code> and/or <code>plugins</code> to prefix(update) the URLs in the modules. In the <code>production</code> mode, we usually use this option to specify the CDN address, so we don’t need to manually update the URLs in all the files to point to the CDN. </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// One of the below</span></span><br><span class="line">    publicPath: <span class="string">'https://cdn.example.com/assets/'</span>, <span class="comment">// CDN (always HTTPS)</span></span><br><span class="line">    publicPath: <span class="string">'//cdn.example.com/assets/'</span>, <span class="comment">// CDN (same protocol)</span></span><br><span class="line">    publicPath: <span class="string">'/assets/'</span>, <span class="comment">// server-relative</span></span><br><span class="line">    publicPath: <span class="string">'assets/'</span>, <span class="comment">// relative to HTML page</span></span><br><span class="line">    publicPath: <span class="string">'../assets/'</span>, <span class="comment">// relative to HTML page</span></span><br><span class="line">    publicPath: <span class="string">''</span>, <span class="comment">// relative to HTML page (same directory)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>But, here is alway a <strong>But</strong>. When the <code>output.publicPath</code> is not a CDN address, it will influence the output result when we start the <code>webpack-dev-server</code>. I’m really bad at googling staff, I tried to find some articles, but they didn’t meet my expectations. And the document of <code>Webpack</code> is also terrible.</p>
<p>There are common mistakes we usually meet.</p>
<ol>
<li>If we assign the values for <code>devServer.publicPath</code> and <code>output.publicPath</code>, but the values are different. The html cabn be loaded successfully, but the bundle and the other resource can not be accessed.<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  output: &#123;</span><br><span class="line">    publicPath: <span class="string">'/notdist/'</span>,</span><br><span class="line"></span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    <span class="comment">// static files served from here</span></span><br><span class="line">    publicPath: <span class="string">'/dist/'</span>,</span><br><span class="line"></span><br><span class="line">    port: <span class="number">2000</span>,</span><br><span class="line">    stats: <span class="string">'errors-only'</span>,</span><br><span class="line">    open: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/Setup-Webpack-from-Scratch/webpack-error-1.png" width="80%" margin="auto"></p>
<ol>
<li>If both of these <code>publicPath</code>s are not given values, the default value of the <code>devServer.publicPath</code> is ‘/‘, and the default value of the <code>output.publicPath</code> is ‘’. That will be ok. But if we assigned a value to the <code>output.publicPath</code>, but didn’t give a value to the <code>devServer.publicPath</code>, the <code>devServer.publicPath</code> will use the <code>output.publicPath</code> value!<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  output: &#123;</span><br><span class="line">    publicPath: <span class="string">'/dist/'</span>,</span><br><span class="line"></span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    <span class="comment">// static files served from here</span></span><br><span class="line">    <span class="comment">// publicPath: '/dist/',</span></span><br><span class="line"></span><br><span class="line">    port: <span class="number">2000</span>,</span><br><span class="line">    stats: <span class="string">'errors-only'</span>,</span><br><span class="line">    open: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> NODE_ENV=development webpack-dev-server --config ./build/webpack.config.js</span><br><span class="line"></span><br><span class="line">clean-webpack-plugin: /Users/qinqubo/Magicefire/Playground/webpack-learning/dist has been removed.</span><br><span class="line">ℹ ｢wds｣: Project is running at http://localhost:2000/</span><br><span class="line">ℹ ｢wds｣: webpack output is served from /dist/</span><br><span class="line">⚠ ｢wdm｣:</span><br><span class="line">ℹ ｢wdm｣: Compiled with warnings.</span><br></pre></td></tr></table></figure>
<p><img src="/Setup-Webpack-from-Scratch/webpack-error-2.png" width="80%" margin="auto"><br>It is not an error, but it is very confused:(</p>
<ol>
<li>The example before, we start the <code>output.publicPath</code> with the ‘/‘, so it is a server-relative path. So far everything is fine. But if we set this option using an address which is relative to HTML page, like ‘dist/‘<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  output: &#123;</span><br><span class="line">    publicPath: <span class="string">'dist/'</span>,</span><br><span class="line"></span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    <span class="comment">// static files served from here</span></span><br><span class="line">    <span class="comment">// publicPath: '/dist/',</span></span><br><span class="line">    <span class="comment">// open app in localhost:2000</span></span><br><span class="line">    port: <span class="number">2000</span>,</span><br><span class="line">    stats: <span class="string">'errors-only'</span>,</span><br><span class="line">    open: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> NODE_ENV=development webpack-dev-server --config ./build/webpack.config.js</span><br><span class="line"></span><br><span class="line">clean-webpack-plugin: /Users/qinqubo/Magicefire/Playground/webpack-learning/dist has been removed.</span><br><span class="line">ℹ ｢wds｣: Project is running at http://localhost:2000/</span><br><span class="line">ℹ ｢wds｣: webpack output is served from /dist/</span><br><span class="line">ℹ ｢wdm｣: wait until bundle finished: /dist/index.html</span><br><span class="line">⚠ ｢wdm｣:</span><br><span class="line">ℹ ｢wdm｣: Compiled with warnings.</span><br></pre></td></tr></table></figure>
<p><code>loaders</code> and <code>plugins</code> will update URLs with the html-relative path, here is the ‘dist/‘, but webpack output is served from ‘/dist/‘, we can access the html file at <code>http://localhost:2000/dist/index.html</code>, The linkers in this html file are pointing to the wrong addresses, such as <code>src=&quot;dist/assets/media/webpacklogo.png&quot;</code> or <code>src=&quot;dist/app.bundle.js&quot;</code> It is a relative path to the html file, but the html file and the bundle filea are already in the <code>dist</code>, and there is no sub-folder called <code>dist</code><br><img src="/Setup-Webpack-from-Scratch/webpack-error-3.png" width="80%" margin="auto"><br><img src="/Setup-Webpack-from-Scratch/webpack-error-4.png" width="80%" margin="auto"></p>
<p>It is a disaster. My suggestion is avoiding using the <code>derServer.publicPath</code> and not using <code>output.publicPath</code> under the <code>development</code> mode. The only purpose of the <code>output.publicPath</code> is setting CDN address under the <code>production</code> mode.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> env = process.env.NODE_ENV      </span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// absolute path declaration</span></span><br><span class="line">    publicPath: env === <span class="string">'development'</span> ? <span class="string">''</span> : <span class="string">'https://cdn.example.com/assets/'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="The-path-of-CleanWebpackPlugin"><a href="#The-path-of-CleanWebpackPlugin" class="headerlink" title="The path of CleanWebpackPlugin"></a>The path of CleanWebpackPlugin</h4><p>If we use <code>CleanWebpackPlugin</code> to remove the ‘dist’ folder, we must set the <code>root</code> value in its options when the config file is not in the root of the project.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line"> <span class="comment">// cleaning up only 'dist' folder</span></span><br><span class="line"> <span class="keyword">new</span> CleanWebpackPlugin([<span class="string">'dist'</span>], &#123;</span><br><span class="line">   root: path.resolve(__dirname, <span class="string">'../'</span>),</span><br><span class="line"> &#125;),</span><br></pre></td></tr></table></figure>
<p>You can check out on the <code>test-publicpath</code> branch on <a href="https://github.com/quboqin/webpack-learning" target="_blank" rel="noopener">Github</a>.</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/dirname/" rel="tag"># __dirname</a>
          
            <a href="/tags/path/" rel="tag"># path</a>
          
            <a href="/tags/" rel="tag"># ../</a>
          
            <a href="/tags/" rel="tag"># ./</a>
          
            <a href="/tags/require/" rel="tag"># require</a>
          
            <a href="/tags/readFileSync/" rel="tag"># readFileSync</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/From-MVC-to-MVVM-C-Step-by-Step/" rel="next" title="From MVC to MVVM-C, Step by Step, Part I">
                <i class="fa fa-chevron-left"></i> From MVC to MVVM-C, Step by Step, Part I
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Qubo Qin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">32</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#What-is-the-difference-between-dirname-and-in-Nodejs"><span class="nav-number">1.</span> <span class="nav-text">What is the difference between __dirname and ./ in Nodejs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-Paths-in-the-webpack-config-js"><span class="nav-number">2.</span> <span class="nav-text">The Paths in the webpack.config.js</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Common-Options"><span class="nav-number">2.0.1.</span> <span class="nav-text">Common Options</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#The-Most-Confused-Part-publicPath"><span class="nav-number">2.0.2.</span> <span class="nav-text">The Most Confused Part, publicPath</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#The-path-of-CleanWebpackPlugin"><span class="nav-number">2.0.3.</span> <span class="nav-text">The path of CleanWebpackPlugin</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qubo Qin</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v6.7.0</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=6.7.0"></script>

  <script src="/js/src/motion.js?v=6.7.0"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=6.7.0"></script>



  
  <script src="/js/src/scrollspy.js?v=6.7.0"></script>
<script src="/js/src/post-details.js?v=6.7.0"></script>



  


  <script src="/js/src/bootstrap.js?v=6.7.0"></script>



  


  


  





  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
